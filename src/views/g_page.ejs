<!DOCTYPE html>
<html lang="en">
  <!-- Header -->
  <%- include('layouts/header'); -%>
  <body>
    <!-- Navbar -->
    <%- include('layouts/navbar'); -%>

    <!-- Main Content -->

    <main class="g-page-main-div-style">
      <div class="background-container">
        <div class="overlay-style"></div>
        <div class="content-wrapper">
          <!-- Introductory Text -->
          <div class="intro-text">
            <% if (loggedIn) { %>
            <h1>Hello <%= username %></h1>
            <% } %>
            <h2>Welcome to the G Test Data Retrieval Portal</h2>
          </div>
        </div>
      </div>
      <div class="g-page-container">
        <div class="g-page-form-container">
          <h2 class="text-center">Your Information</h2>

          <% if (user && user.licenseNumber !== "default") { %>
          <p class="pb-2 bigger-text">
            <strong>Name:</strong> <%= user.firstName %> <%= user.lastName %>
          </p>
          <p class="pb-2 license-number-style bigger-text">
            <strong>License Number:</strong> <%= decryptedLicenseNumber %>
          </p>
          <p class="pb-2 bigger-text"><strong>Age:</strong> <%= user.age %></p>
          <p class="pb-2 bigger-text">
            <strong>Date of Birth:</strong> <%= formattedDob %>
          </p>

          <h2 class="text-center mt-4 pt-1">Booked Appointment</h2>
          <% if (appointmentDetails) { %>
          <div class="appointment-info">
            <p><strong>Date:</strong> <%= appointmentDetails.date %></p>
            <p><strong>Time:</strong> <%= appointmentDetails.time %></p>
            <p><strong>Location:</strong> <%= appointmentDetails.location %></p>
          </div>
          <% } else { %>
          <p class="no-booked-appointment-style">
            You have no booked appointments.
            <a href="/g2">Book an appointment here.</a>
          </p>
          <% } %>

          <h2 class="text-center mt-4 pt-3">Update Car Information</h2>
          <form id="gForm" action="/g" method="POST">
            <label for="carMake">Make:</label>
            <input
              type="text"
              id="carMake"
              name="make"
              value="<%= user.car_details.make || '' %>"
              required
            />

            <label for="carModel" class="mt-3">Model:</label>
            <input
              type="text"
              id="carModel"
              name="model"
              value="<%= user.car_details.model || '' %>"
              required
            />

            <label for="carYear" class="mt-3">Year:</label>
            <input
              type="text"
              id="carYear"
              name="year"
              value="<%= user.car_details.year || '' %>"
              required
            />

            <label for="carplateNumber" class="mt-3">Plate Number:</label>
            <input
              type="text"
              id="carplateNumber"
              name="plateNumber"
              value="<%= user.car_details.plateNumber || '' %>"
              required
            />

            <div class="d-flex align-items-center justify-content-center mt-4">
              <button type="submit" class="button">Update Information</button>
            </div>
          </form>
          <% } else { %>
          <!-- Show message to fill out the G2 form if user data is default -->
          <h4 class="text-center">
            Please fill out the G2 form to view your information.
          </h4>
          <% } %>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <%- include('layouts/footer'); -%> <%- include('layouts/scripts'); -%>
  </body>
</html>
